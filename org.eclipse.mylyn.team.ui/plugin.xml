<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.0"?>
<plugin>
   <extension-point id="changeSets" name="Task-Focused Change Providers" schema="schema/changeSets.exsd"/>
   <extension-point id="commitTemplates" name="Commit Template Handlers" schema="schema/commitTemplates.exsd"/>
    
    <!-- needed to update change sets -->
    <extension
         name="Mylyn Change Set Management"
         point="org.eclipse.ui.startup">
    </extension>

  <extension
         point="org.eclipse.mylyn.team.ui.changeSets">
      <contextChangeSetManager
            class="org.eclipse.mylyn.internal.team.ui.ContextActiveChangeSetManager">
      </contextChangeSetManager>
   </extension>
    
   <extension
         point="org.eclipse.ui.decorators">
      <decorator
            class="org.eclipse.mylyn.internal.team.ui.ContextChangeSetDecorator"
            id="org.eclipse.mylyn.team.ui.changeset.decorator"
            label="Task Change Set Decorator"
            lightweight="true"
            objectClass="org.eclipse.mylyn.internal.team.ui.ContextChangeSet"
            state="true">
      </decorator>
    </extension>
    
     <extension point="org.eclipse.ui.popupMenus"> 

     	<objectContribution
				id="org.eclipse.mylyn.ui.team.synchronize.open.report.contribution"
				objectClass="org.eclipse.mylyn.tasks.core.ILinkedTaskInfo"
				adaptable="true">
			<action
				class="org.eclipse.mylyn.internal.team.ui.actions.OpenCorrespondingTaskAction"
				enablesFor="1" 
				icon="icons/elcl16/task-repository.gif"
				id="org.eclipse.mylyn.ui.team.synchronize.open.report.linked"
				label="Open Corresponding Task"
				menubarPath="mylyn"
				tooltip="Open Corresponding Task">
			</action> 
			<action
				class="org.eclipse.mylyn.internal.team.ui.actions.AddToTaskContextAction"
				enablesFor="*" 
				icon="icons/elcl16/context-add.gif"
				id="org.eclipse.mylyn.ui.team.synchronize.create.context"
				label="Add to Task Context"
				menubarPath="mylyn"
				tooltip="Add to Task Context">
			</action> 
		</objectContribution>

		<objectContribution
            objectClass="org.eclipse.team.internal.ui.synchronize.SyncInfoModelElement"
            id="org.eclipse.mylyn.ui.team.synchronize.open.report.syncinfo">
            <action
				class="org.eclipse.mylyn.internal.team.ui.actions.AddToTaskContextAction"
				enablesFor="*" 
				icon="icons/elcl16/context-add.gif"
				id="org.eclipse.mylyn.ui.team.synchronize.create.context"
				label="Add to Task Context"
				menubarPath="mylyn"
				tooltip="Add to Task Context">
			</action> 
		</objectContribution>
		<objectContribution
            objectClass="org.eclipse.team.internal.ui.synchronize.UnchangedResourceModelElement"
            id="org.eclipse.mylyn.ui.team.synchronize.open.report.unchanged">
            <action
				class="org.eclipse.mylyn.internal.team.ui.actions.AddToTaskContextAction"
				enablesFor="*" 
				icon="icons/elcl16/context-add.gif"
				id="org.eclipse.mylyn.ui.team.synchronize.create.context"
				label="Add to Task Context"
				menubarPath="mylyn"
				tooltip="Add to Task Context">
			</action> 
		</objectContribution>
	</extension>
    
    <extension point="org.eclipse.ui.navigator.navigatorContent">
	   <actionProvider           
	   	 class="org.eclipse.mylyn.internal.team.ui.actions.TaskResourceMappingActionProvider"
	     id="org.eclipse.mylyn.ide.ui.actions.TaskResourceMappingActionProvider">
	     <enablement>
	       <adapt type="org.eclipse.core.resources.mapping.ResourceMapping"/>
	     </enablement>
	   </actionProvider>
	</extension>
	
  <extension point="org.eclipse.ui.preferencePages">
      <page 
         name="Team"
         class="org.eclipse.mylyn.internal.team.ui.preferences.FocusedTeamPreferencePage"
         id="org.eclipse.mylyn.team.ui.ui.preferences"
         category="org.eclipse.mylyn.ui.preferences">
         <keywordReference id="org.eclipse.mylyn.team.ui.keywords"/>
      </page> 
   </extension>
   
   <extension
   		point="org.eclipse.ui.keywords">
      <keyword
            label="mylyn team"
            id="org.eclipse.mylyn.team.ui.keywords"/>
   </extension>
  
   	<extension point="org.eclipse.ui.navigator.viewer">
	   <viewerActionBinding
	      viewerId="org.eclipse.team.cvs.ui.workspaceSynchronization">
	        <includes>
	           <actionExtension
			       pattern="org.eclipse.mylyn.ide.ui.actions.TaskResourceMappingActionProvider"/>
	        </includes>
	   </viewerActionBinding>
    <dragAssistant
          class="org.eclipse.ui.navigator.resources.ResourceDragAdapterAssistant"
          viewerId="org.eclipse.mylyn.team.ui.cvs.ui.dragAssistant">
    </dragAssistant>
	</extension>
	
    <extension
          point="org.eclipse.mylyn.team.ui.commitTemplates">
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$ConnectorTaskPrefix"
             description="Task repository-specific connector prefix, e.g. bug"
             recognizedKeyword="connector.task.prefix"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$RepositoryKind"
             description="Provides the repository kind of a task"
             recognizedKeyword="repository.kind"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$RepositoryUrl"
             description="Provides the repository URL of a task."
             recognizedKeyword="repository.url"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskAssignee"
             description="Provides the user a task is assigned to, if available."
             recognizedKeyword="task.assignee"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskCc"
             description="Provides the comma separated CC list of a task, if available."
             recognizedKeyword="task.cc"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskDescription"
             description="Provides the description of a task."
             recognizedKeyword="task.description"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskId"
             description="Provides the ID of a task."
             recognizedKeyword="task.id"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskKey"
             description="Provides the key of a task, for most repositories this is equals to the ID."
             recognizedKeyword="task.key"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskKeywords"
             description="Provides the comma separated keyword list of a task, if available."
             recognizedKeyword="task.keywords"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskLastModified"
             description="Provides the date of last modification of a task, if available."
             recognizedKeyword="task.lastmodified"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskNotes"
             description="Provides the notes of a task."
             recognizedKeyword="task.notes"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskPriority"
             description="Provides the priority of a task."
             recognizedKeyword="task.priority"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskProduct"
             description="Provides the prroduct a task belongs to, if available."
             recognizedKeyword="task.product"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskReporter"
             description="Provides the user who reported a task, if available."
             recognizedKeyword="task.reporter"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskResolution"
             description="Provides the resolution of a task, if available."
             recognizedKeyword="task.resolution"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskStatus"
             description="Provides the status of a task, if available."
             recognizedKeyword="task.status"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskSummary"
             description="Provides the summary or description of a task, whichever is available."
             recognizedKeyword="task.summary"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskType"
             description="Provides the type of a task."
             recognizedKeyword="task.type"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$TaskURL"
             description="Provides the URL of a task."
             recognizedKeyword="task.url"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$CommitTemplateDate$TaskCompletion"
             description="Provides the completion date of a task."
             recognizedKeyword="task.completiondate"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$CommitTemplateDate$TaskCreation"
             description="Provides the creation date of a task."
             recognizedKeyword="task.creationdate"/>
       <templateVariable
             class="org.eclipse.mylyn.internal.team.ui.templates.CommitTemplateVariables$CommitTemplateDate$TaskReminder"
             description="Provides the reminder date of a task."
             recognizedKeyword="task.reminderdate"/>
    </extension>
	
   <extension point="org.eclipse.core.runtime.adapters">
     <factory adaptableType="org.eclipse.mylyn.internal.team.ui.ContextChangeSet"
             class="org.eclipse.mylyn.internal.team.ui.LinkedTaskInfoAdapterFactory">
       <adapter type="org.eclipse.mylyn.tasks.core.ILinkedTaskInfo"/>
     </factory>
    <factory adaptableType="org.eclipse.team.core.history.IFileRevision"
             class="org.eclipse.mylyn.internal.team.ui.LinkedTaskInfoAdapterFactory">
       <adapter type="org.eclipse.mylyn.tasks.core.ILinkedTaskInfo"/>
    </factory>
    <factory adaptableType="org.eclipse.team.internal.core.subscribers.DiffChangeSet"
             class="org.eclipse.mylyn.internal.team.ui.LinkedTaskInfoAdapterFactory">
       <adapter type="org.eclipse.mylyn.tasks.core.ILinkedTaskInfo"/>
    </factory>
    <factory adaptableType="org.eclipse.team.internal.ui.synchronize.ChangeSetDiffNode"
             class="org.eclipse.mylyn.internal.team.ui.LinkedTaskInfoAdapterFactory">
       <adapter type="org.eclipse.mylyn.tasks.core.ILinkedTaskInfo"/>
    </factory>
  </extension>
	
</plugin>
